(function(e){e.fn.extend({smoothZoom:function(t){function i(){var n=e(window).height(),r=e(window).width(),i=e("#off-screen").width(),o=e("#off-screen").height(),u=n*.95,a=u/o,f=i*a;e("#lightwrap img").show();if(u>o){e("#lightwrap img").animate({height:o,width:i,left:"50%",top:"50%",marginTop:-(o/2),marginLeft:-(i/2)},t.zoominSpeed,t.zoominEasing)}else{if(f>r){s()}else{e("#lightwrap img").animate({height:u,width:f,left:"50%",top:"2.5%",marginTop:"0",marginLeft:-(f/2)},t.zoominSpeed,t.zoominEasing)}}}function s(){var n=e("#off-screen").width(),r=e("#off-screen").height(),s=e(window).width(),o=e(window).height(),u=s*.95,a=u/n,f=r*a;e("#lightwrap img").show();if(f>r){if(r>o){i()}else{e("#lightwrap img").animate({height:r,width:n,top:"50%",left:"50%",marginTop:-(r/2),marginLeft:-(n/2)},t.zoominSpeed,t.zoominEasing)}}else{if(f>o){i()}else{e("#lightwrap img").animate({height:f,width:u,top:"50%",left:"2.5%",marginTop:-(f/2),marginLeft:"0"},t.zoominSpeed,t.zoominEasing)}}}var n={zoominSpeed:800,zoomoutSpeed:400,resizeDelay:400,zoominEasing:"easeOutExpo",zoomoutEasing:"easeOutExpo"};var t=e.extend(n,t);e('img[rel="zoom"]').click(function(t){var n=e(this).attr("src"),r=e(this).parent().attr("href"),i=e(this).parent().attr("target"),o=e(this).offset(),u=e(this).width(),a=e(this).height(),f=e(window).scrollTop(),l=e(window).width(),c=e(window).height();if(!r||r=="#"){e("body").append("<div id='lightwrap'><img src="+n+"></div><div id='lightbg'></div><img id='off-screen' src="+n+">");e("#off-screen").load(function(){e("#lightwrap img").css({width:u,height:a,top:o.top-f,left:o.left});s();e("#lightbg").fadeIn()});e(this).attr("id","lightzoomed")}else if(r.match("[jpg|png|gif|JPG|PNG|GIF](\\?.*?)?$")){e("body").append("<div id='lightwrap'><img src="+r+"></div><div id='lightbg'></div><img id='off-screen' src="+r+">");e("#off-screen").load(function(){e("#lightwrap img").css({width:u,height:a,top:o.top-f,left:o.left});s();e("#lightbg").fadeIn()});e(this).attr("id","lightzoomed")}else{if(i=="_blank"){window.open(r,"_blank")}else{window.location=r}}t.preventDefault()});e(document.body).on("click","#lightwrap, #lightbg",function(n){var r=e("#lightzoomed").offset(),i=e("#lightzoomed").width(),s=e("#lightzoomed").height(),o=e(window).scrollTop();e("#lightbg").fadeOut(500);e("#lightwrap img").animate({height:s,width:i,top:r.top-o,left:r.left,marginTop:"0",marginLeft:"0"},t.zoomoutSpeed,t.zoomoutEasing,function(){e("#lightwrap, #lightbg, #off-screen").remove();e("#lightzoomed").removeAttr("id")})});var r=function(){var e=0;return function(t,n){clearTimeout(e);e=setTimeout(t,n)}}();e(window).resize(function(){r(function(){s()},t.resizeDelay)})}})})(jQuery)